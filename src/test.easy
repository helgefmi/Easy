def test_functions4 do
    printf("SUCCESS")
end

def test_functions3 do
    test_functions4()
end

def test_functions2 do
    test_functions3()
end

def test_functions do
    printf("Trying to reach test_functions4.. ")
    test_functions2()
    puts("")
end

def test_if do
    if atoi("0") then
        puts("ERROR. 0")
    else
        puts("OK. 0")
    end

    if atoi("1") then
        puts("OK. 1")
    else
        puts("ERROR. 1")
    end

    if (atoi("5") * 5) < 25 then
        puts("ERROR. 5 * 5 < 25")
    else
        puts("OK. 5 * 5 < 25")
    end
end

def test_compare do
    if atoi("1") < 2 then
        puts("OK. 1 < 2")
    else
        puts("ERROR. 1 < 2")
    end

    if atoi("1") > 2 then
        puts("ERROR. 1 > 2")
    else
        puts("OK. 1 > 2")
    end

    if atoi("2") > 2 then
        puts("ERROR. 2 > 2")
    else
        puts("OK. 2 > 2")
    end

    if atoi("2") >= 2 then
        puts("OK. 2 >= 2")
    else
        puts("ERROR. 2 >= 2")
    end

    if atoi("55") == 55 then
        puts("OK. 55 == 55")
    else
        puts("ERROR. 55 == 55")
    end

    if atoi("66") != 66 then
        puts("ERROR. 66 != 66")
    else
        puts("OK. 66 != 66")
    end
end

def test_arithmetic do
    printf("50 + 8 = %d\n" (atoi("50") + 8))
    printf("50 * 8 = %d\n" (atoi("50") * 8))
    printf("50 - 8 = %d\n" (atoi("50") - 8))
end

def test_binop do
    puts("test_compare()")
    test_compare()

    puts("test_arithmetic()")
    test_arithmetic()
end

def test_crazy do
    printf(
        "hei: %d %d (%s) / %d %d\n"
        strlen("a")
        time(atoi("0"))
        "hehe"
        atoi("252")
        strcmp("AKKI" strstr("I SAY EKKI!" "EKKI"))
    )

    printf("%d\n" strcmp("AKKI" strdup(strstr("I SAY EKKI!" "EKKI"))))
    printf("%d\n" strcmp("OKKI" strstr("I SAY EKKI!" "EKKI")))

    printf("%d of \"%s\" is \"" 5 "Lorem ipsum dolor sit amet")
    fflush(0)
end

def test_constant_folding do
    printf("5 * 5 = %d\n" (5 * 5))
    printf("9 > 5 = %d\n" (9 > 5))
    printf("9 <= 5 = %d\n" (9 <= 5))
end

def print_num(a) do
    printf("%d\n" a)
end

def test_function_arguments do
    print_num(5)
end

def test do
    puts("test_functions()")
    test_functions()

    puts("\ntest_if()")
    test_if()

    puts("\ntest_binop()")
    test_binop()

    puts("\ntest_constant_folding()")
    test_constant_folding()

    puts("\ntest_function_arguments()")
    test_function_arguments()
end

def main do
    test()
end
